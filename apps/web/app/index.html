<canvas id="bg"></canvas>
<script>
  const canvas = document.getElementById("bg");
  const ctx = canvas.getContext("2d");

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener("resize", resize);
  resize();

  const stars = [];
  const STAR_COUNT = 400;

  for (let i = 0; i < STAR_COUNT; i++) {
    stars.push({
      x: Math.random(),
      y: Math.random(),
      r: Math.random() * 1.5 + 0.3,
      baseAlpha: Math.random() * 0.7 + 0.3,
      twinkleSpeed: Math.random() * 2 + 0.5,
      colorType: Math.random()
    });
  }

  function drawGradientBackground() {
    const g = ctx.createLinearGradient(0, 0, 0, canvas.height);
    g.addColorStop(0, "#02010A");
    g.addColorStop(0.4, "#050526");
    g.addColorStop(1, "#001B3F");
    ctx.fillStyle = g;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  }

  function draw() {
    const t = performance.now() / 1000;

    drawGradientBackground();

    ctx.save();
    ctx.globalCompositeOperation = "lighter";

    for (const s of stars) {
      const alpha =
        s.baseAlpha * (0.6 + 0.4 * Math.sin(t * s.twinkleSpeed + s.x * 10.0));

      let color;
      if (s.colorType < 0.7) color = `rgba(240, 248, 255, ${alpha})`; // 白寄り
      else if (s.colorType < 0.85) color = `rgba(77, 213, 255, ${alpha})`; // シアン
      else color = `rgba(255, 221, 119, ${alpha})`; // 金色

      const x = s.x * canvas.width;
      const y = s.y * canvas.height;

      const grd = ctx.createRadialGradient(x, y, 0, x, y, s.r * 4);
      grd.addColorStop(0, color);
      grd.addColorStop(1, "rgba(0,0,0,0)");

      ctx.fillStyle = grd;
      ctx.beginPath();
      ctx.arc(x, y, s.r * 4, 0, Math.PI * 2);
      ctx.fill();
    }

    ctx.restore();

    requestAnimationFrame(draw);
  }

  draw();
</script>
